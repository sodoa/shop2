/*! js weidian 2015-06-18 */
window.cartBtnModule=function(){function a(a,b){this._wrapper=a,this._view=b.view,this._containerClass=b.cartClass,this._activeClass=b.activeClass,this.initialize()}a.prototype={initialize:function(){this._mContainer=this.renderView(),this.active(),window.innerWidth>640&&this.ajustPosition(),this._addEvents()},renderView:function(){return this._append(this._wrapper,this._view),$("."+this._containerClass)},_append:function(a,b){var c=document.createElement("div");c.innerHTML=b,a.getDom()[0].appendChild(c.children[0])},_addEvents:function(){M.loadScript("http://s.koudai.com/script/common/jumpUtil.js");var a=this;a._mContainer.bind("click",function(){M.gaq($(this).attr("data-for-gaq")),a.disActive(),jumpUtil.gotoCart()})},ajustPosition:function(){var a=0;a=(window.innerWidth-640)/2,a+=11,this._mContainer.getDom()[0].style.right=a+"px"},disActive:function(){M.setCookie("cart_active","0"),this._mContainer.removeClass(this._activeClass)},active:function(a){a&&M.setCookie("cart_active","1");var b=this;"0"!==M.getCookie("cart_active")&&b._getItemCount(function(a){a>0&&b._mContainer.addClass(b._activeClass)})},_getItemCount:function(a){if(+M.getCookie("cart_inner_item_count")>0)a(+M.getCookie("cart_inner_item_count"));else if(M.isLogin())M.ajax({type:"jsonp",part:"UDC",url:"http://wd.koudai.com/wd/shoppingcart/list?param="+M.toJSON({buyer_id:M.getCookie("WD_b_id"),wduss:M.getCookie("WD_b_wduss"),only_total:1}),success:function(b){a(+b.result.total),M.setCookie("cart_inner_item_count",b.result.total)}});else if(M.getCookie("cart_seller_list")){var b=M.getCookie("cart_seller_list").split(","),c=0;b.forEach(function(a){c+=M.getCookie("cart_"+a+"_i").split(",").length}),M.setCookie("cart_inner_item_count",c),a(c)}}};var b="进入购物车;店铺页";return/item.html/.test(window.location.href)&&(b="进入购物车;详情页"),new a($("body"),{view:'<div class="cart_btn for_gaq" data-for-gaq="'+b+'"><span></span></div>',cartClass:"cart_btn",activeClass:"active"})}();