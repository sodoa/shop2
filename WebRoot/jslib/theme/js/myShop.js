/*! js weidian 2015-05-12 */
!function(){function a(a,b){this._wrapper=a,this._view=b.view,this._containerClass=b.cartClass,this._activeClass=b.activeClass,this.initialize()}a.prototype={initialize:function(){this._mContainer=this.renderView(),this.active(),this.addEvents()},renderView:function(){return this._append(this._wrapper,this._view),$("."+this._containerClass)},_append:function(a,b){var c=document.createElement("div");c.innerHTML=b,a.getDom()[0].appendChild(c.children[0])},addEvents:function(){M.loadScript("http://s.koudai.com/script/common/jumpUtil.js");var a=this;a._mContainer.bind("click",function(){a.disActive(),jumpUtil.gotoMyShop(parseInt(M.urlQuery("userid"))),M.gaq($(this).attr("data-for-gaq"))})},disActive:function(){M.setCookie("WD_order_active","0"),M.getCookie("WD_unpay_oID")&&M.setCookie("WD_order_disactive_id",M.getCookie("WD_unpay_oID")),this._mContainer.removeClass(this._activeClass)},active:function(){var a=this,b=M.getCookie("WD_unpay_oID"),c=M.getCookie("WD_order_disactive_id");b&&c!=b&&M.setCookie("WD_order_active","1"),"0"!==M.getCookie("WD_order_active")&&a.getItemCount(function(b){b>0&&a._mContainer.addClass(a._activeClass)})},getItemCount:function(a){+M.getCookie("unreadMsg")?a(+M.getCookie("unreadMsg")):M.isLogin()&&M.ajax({type:"jsonp",part:"UDC",url:"http://wd.koudai.com/wd/buyer/order/getUnpayOrderNum?param="+M.toJSON({buyer_id:M.getCookie("WD_b_id"),wduss:M.getCookie("WD_b_wduss")}),success:function(b){a(+b.result.num),M.setCookie("unreadMsg",b.result.num)}})}};var b="点击我的微店;店铺页";return/item.html/.test(window.location.href)&&(b="点击我的微店;详情页"),new a($("#common_hd"),{view:'<div class="my_shop for_gaq" data-for-gaq="'+b+'"><span></span></div>',cartClass:"my_shop",activeClass:"active"})}();